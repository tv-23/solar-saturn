---
import "../../../public/style/floating-container.css";

import { ui } from "../../src/i18n/ui";

const { lang = "en" } = Astro.props;
const t = ui[lang];
const data = t["why_seatrust.secion.items"];
---

<div class="container-fluid wecargo-section">
    <div class="row">
        <!-- LEFT: STICKY IMAGE -->
        <div class="col-lg-5  offset-lg-1 sticky-col">
            <img
                src="/images/tonir.png"
                alt="WeCargo Container"
                class="cargo-img"
            />
        </div>

        <!-- RIGHT: SCROLLABLE LIST -->
        <div
            class="col-lg-6 content-col"
            style="padding-bottom: 0;"
        >
            <h1 class="hero-title">
                {t["why_seatrust.secion.name"]["p1"]}<br />
                {t["why_seatrust.secion.name"]["p2"]}
            </h1>

            <div class="services-list">
                <!-- 01 -->
                {
                    data.map((d) => (
                        <div class="service-item">
                            <span class="service-num">{d.nbr}</span>
                            <h3 class="service-title">{d.title}</h3>
                            <p class="service-desc">{d.description}</p>
                        </div>
                    ))
                }
            </div>
        </div>

        <div class="col-lg-11 d-none d-lg-block">
            <div style="position: relative;">
                <img
                    src="/images/truck-il.svg"
                    alt="WeCargo Container"
                    id="the_truck11"
                    style="width: 100%;
                position: absolute;top:0"
                />
            </div>
        </div>

        <div class="col-lg-1 d-none d-lg-block" id="partSideTruck" style="height: 370px;"></div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", () => {

        
        
        const sticky = document.querySelector(".sticky-col");
        const stopEl = document.getElementById("the_truck11");
        const section = document.querySelector(".wecargo-section");
        document.getElementById("partSideTruck").style.height = stopEl.clientHeight+"px";

        if (!sticky || !stopEl || !section) return;

        const DESKTOP_WIDTH = 992; // Bootstrap lg breakpoint



        function resetSticky() {
            sticky.style.position = "";
            sticky.style.top = "";
        }

        function updateSticky() {
            // ðŸš« Disable on mobile / tablet
            if (window.innerWidth < DESKTOP_WIDTH) {
                resetSticky();
                return;
            }

            const sectionRect = section.getBoundingClientRect();
            const stopRect = stopEl.getBoundingClientRect();
            const stickyHeight = sticky.offsetHeight;
            const HeightOfTruck = stopEl.clientHeight

            document.getElementById("partSideTruck").style.height = HeightOfTruck+"px";


            // 67% stop point on the truck
            const stopTop = stopRect.top + HeightOfTruck * 0.636;

            const stickyBottom = stickyHeight;

            if (stickyBottom >= stopTop) {
                sticky.style.position = "relative";
                sticky.style.top =
                    stopRect.top -
                    stickyHeight -
                    sectionRect.top +
                    HeightOfTruck * 0.636 +
                    "px";
            } else {
                sticky.style.position = "sticky";
                sticky.style.top = "0";
            }
        }

        window.addEventListener("scroll", updateSticky);
        window.addEventListener("resize", updateSticky);
    });
</script>
